# ESLint Plugin - LLM-Optimized Message Format

You are working in the @forge-js/eslint-plugin package. When creating or modifying ESLint rule messages, **ALWAYS use `formatLLMMessage` utility** from `@forge-js/eslint-plugin-utils`.

## Format Standard

Every error/warning message MUST use `formatLLMMessage` which produces exactly 2 lines:

```
Line 1: [Icon] [CWE?] | [Description] | [SEVERITY]
Line 2:    Fix: [fix instruction] | [documentation link]
```

## Quick Reference

**Severity Levels:** CRITICAL | HIGH | MEDIUM | LOW

**Icons by Category:**

- üîí Security issues (vulnerabilities)
- ‚ö†Ô∏è Warnings/general issues
- üîÑ Refactoring/architecture issues
- ‚ôø Accessibility issues
- ‚ö° Performance issues
- üìö Domain/terminology issues
- üö´ Module/import issues

**CWE References:** https://cwe.mitre.org/

- CWE-89: SQL Injection
- CWE-78: Command Injection
- CWE-95: Code Injection (eval, require)
- CWE-22: Path Traversal
- CWE-400: ReDoS
- CWE-915: Prototype Pollution
- CWE-407: Circular Dependencies
- CWE-431: Insecure Dependency
- CWE-532: Sensitive Data Logging
- CWE-1078: Deprecated API
- CWE-1104: Code Duplication

## Implementation Template

```typescript
import { formatLLMMessage, MessageIcons } from '@forge-js/eslint-plugin-utils';

messages: {
  ruleName: formatLLMMessage({
    icon: MessageIcons.SECURITY, // or appropriate icon
    issueName: 'Issue Name',
    cwe: 'CWE-XXX', // optional, only if relevant
    description: 'Issue description',
    severity: 'CRITICAL', // or HIGH, MEDIUM, LOW
    fix: 'Specific fix instruction with code example',
    documentationLink: 'https://example.com/docs',
  }),
}
```

## DO's ‚úÖ

- **ALWAYS use `formatLLMMessage` utility**
- Import from `@forge-js/eslint-plugin-utils`
- Use `MessageIcons` constants for icons
- Include CWE references when relevant (security, high-impact)
- Provide specific fix instructions with code examples
- Link to documentation
- Use correct severity level (CRITICAL, HIGH, MEDIUM, LOW)
- Test on playground app

## DON'Ts ‚ùå

- Skip CWE references
- Use vague examples
- Provide only problems
- Mix unrelated concepts
- Create biased rules
- Add special-case logic
- Forget severity/icon
- Skip documentation

## Reference Rules

See `/src/rules/` for optimized examples:

- `security/no-sql-injection.ts` - Security example
- `architecture/no-circular-dependencies.ts` - Architecture example
- `development/no-console-log.ts` - Development example

## When in Doubt

1. Check existing rules in the same category
2. Reference the full guide: `.cursor/rules/eslint-rule-llm-format.md`
3. Run `nx lint` on the playground app to verify
4. Ensure message is parseable by both humans and LLMs

## Acceptable Placeholder Usage

Some rules MAY use template placeholders in specific, justified cases:

‚úÖ **ACCEPTABLE Examples:**

- Domain-specific terms (`{{correctTerm}}`) - varies per project glossary
- Accessibility levels (`{{wcagLevel}}`) - varies per context (A, AA, AAA)
- Contextual locations (`{{location}}`) - varies by error source (onClick, map, etc.)

‚ùå **NOT ACCEPTABLE Examples:**

- Main message severity (`{{severity}}`) - should be static (CRITICAL/HIGH/MEDIUM/LOW)
- CWE references (`{{cweCode}}`) - should be static (CWE-89, CWE-95, etc.)
- Core examples (`{{currentExample}}`, `{{fixExample}}`) - should have static, concrete examples

**Rules that use acceptable placeholders:**

- `img-requires-alt` - Uses dynamic WCAG level and affected user count (justified)
- `react-no-inline-functions` - Uses dynamic location context (justified)
- `enforce-naming` - Uses dynamic domain terms (justified)

**Recent Audit Results (Nov 2, 2025):**

- 5/19 rules: Perfect static format ‚úÖ
- 3/19 rules: Acceptable with justified placeholders üü°
- 3/19 rules: FIXED critical template placeholder issues üî¥
- 8/19 rules: Full review needed ‚ö†Ô∏è
- See: `AUDIT_REPORT_LLM_OPTIMIZATION.md` for complete findings
